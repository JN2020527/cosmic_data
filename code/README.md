# 附件批量处理程序

这个程序可以批量处理Excel附件文件，包括文件重命名、单元格数据更新和需求内容概述生成。

## 功能说明

程序包含以下9个步骤：

### 文件批量修改
1. **第一步**：批量修改文件名字，将`/data_file`下的"附件x-需求名@属性"重新命名，统一替换需求名

### 需求名字修改  
2. **第二步**：基于输入的需求名字，修改附件3中sheet2的A3、B3单元格
3. **第三步**：基于输入的需求名字，修改附件4中B2单元格

### 需求人天计算
4. **第四步**：计算附件5中L列（从L2开始）的工作量总和
5. **第五步**：基于计算结果，修改附件4中D7单元格
6. **第六步**：基于计算结果，修改附件3中sheet2的F3单元格

### 送审时间填充
7. **第七步**：填充当前时间到附件4的C6单元格，格式为"xxxx年x月x日"

### 送审功能点填充
8. **第八步**：基于附件3中sheet2的E3单元格数据，修改附件4中B7单元格

### 总结内容概述
9. **第九步**：基于附件5中H和I列的内容，生成需求内容概述，更新附件4中A4单元格

### WBS工作量分解
10. **第十步**：基于附件4 A4单元格数据和功能点码值，使用AI匹配更新WBS工作量文档
    - 动态读取附件4 D7单元格的工作量总和
    - AI根据实际工作量进行功能点匹配和分配

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

```bash
python process_attachments.py
```

程序会提示输入需求名字，然后自动执行所有9个步骤。

## 输出示例

每个步骤都会输出详细的执行信息，包括：
- 文件重命名情况
- 单元格更新情况  
- 工作量计算结果
- 需求概述生成情况

## 注意事项

- 确保`data_file`目录下包含所需的附件文件
- 附件5必须是.xls格式，其他附件建议使用.xlsx格式
- 程序会自动处理跨工作表的公式计算
- 如果DeepSeek API不可用，会使用本地逻辑生成概述

## 支持的文件格式

- .xlsx：使用openpyxl处理
- .xls：使用xlrd处理
- .docx：仅用于文件重命名 